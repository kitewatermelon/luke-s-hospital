<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë³‘ë™ íŒíŠ¸ ê²Œì„ - ë‘ íŒ€ ì˜ˆì¸¡ ì œì¶œ</title>
</head>
<body>
  <h2>ğŸ² ë³‘ë™ íŒíŠ¸ ê²Œì„ (Seed ì„ íƒ ë° ë‘ íŒ€ ì˜ˆì¸¡ ì œì¶œ)</h2>

  <label for="seedInput">Seed ì…ë ¥ (1~4): </label>
  <input type="number" id="seedInput" min="1" max="4" value="1" />
  <button onclick="startGame()">ê²Œì„ ì‹œì‘</button>

  <hr>

  <label for="wardName">ë³‘ë™ ì´ë¦„ ì…ë ¥ (A~E): </label>
  <input type="text" id="wardName" maxlength="1" placeholder="ì˜ˆ: A" />
  <button onclick="showHint()">íŒíŠ¸ ë°›ê¸°</button>

  <pre id="output"></pre>

  <hr>

  <h3>íŒ€ 1 ì˜ˆì¸¡ ì œì¶œ</h3>
  <form id="predictionForm1" onsubmit="return submitPrediction('íŒ€ 1');">
    <label>A: <input type="number" id="predA1" min="0" required></label><br/>
    <label>B: <input type="number" id="predB1" min="0" required></label><br/>
    <label>C: <input type="number" id="predC1" min="0" required></label><br/>
    <label>D: <input type="number" id="predD1" min="0" required></label><br/>
    <label>E: <input type="number" id="predE1" min="0" required></label><br/>
    <button type="submit">íŒ€ 1 ì˜ˆì¸¡ ì œì¶œ</button>
  </form>

  <pre id="scoreOutput1"></pre>

  <hr>

  <h3>íŒ€ 2 ì˜ˆì¸¡ ì œì¶œ</h3>
  <form id="predictionForm2" onsubmit="return submitPrediction('íŒ€ 2');">
    <label>A: <input type="number" id="predA2" min="0" required></label><br/>
    <label>B: <input type="number" id="predB2" min="0" required></label><br/>
    <label>C: <input type="number" id="predC2" min="0" required></label><br/>
    <label>D: <input type="number" id="predD2" min="0" required></label><br/>
    <label>E: <input type="number" id="predE2" min="0" required></label><br/>
    <button type="submit">íŒ€ 2 ì˜ˆì¸¡ ì œì¶œ</button>
  </form>

  <pre id="scoreOutput2"></pre>

  <hr>
  <pre id="finalResult"></pre>

  <!-- number-to-words.min.jsê°€ í•„ìš”í•˜ë©´ ì¶”ê°€ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/number-to-words/1.2.4/number-to-words.min.js"></script>
  <script src="hint.js"></script> <!-- hint.js ë‚´ë¶€ì— íŒíŠ¸ í•¨ìˆ˜ê°€ ì •ì˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤ -->

  <script>
    const roomData = {
      1: { A: 22, B: 13, C: 37, D: 19, E: 9 },
      2: { A: 14, B: 29, C: 11, D: 27, E: 19 },
      3: { A: 33, B: 17, C: 20, D: 18, E: 22 },
      4: { A: 15, B: 34, C: 16, D: 23, E: 12 }
    };

    let currentWardData = null;
    let turnCount = 0;
    const maxTurns = 12;

    let scores = {
      'íŒ€ 1': null,
      'íŒ€ 2': null
    };

    // ì¤‘ë³µëœ íŒíŠ¸ ë¬¸ì¥ ì €ì¥
    const usedHints = new Set();

    function startGame() {
      const seed = parseInt(document.getElementById('seedInput').value);
      if (!(seed >=1 && seed <=4)) {
        alert('1ì—ì„œ 4 ì‚¬ì´ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
        return;
      }
      currentWardData = roomData[seed];
      turnCount = 0;
      scores = { 'íŒ€ 1': null, 'íŒ€ 2': null };
      usedHints.clear();  // íŒíŠ¸ ì¤‘ë³µ ì´ˆê¸°í™”
      document.getElementById('output').textContent = `Seed ${seed} ì„ íƒë¨. ê²Œì„ ì‹œì‘!\n`;
      document.getElementById('scoreOutput1').textContent = '';
      document.getElementById('scoreOutput2').textContent = '';
      document.getElementById('finalResult').textContent = '';
      document.getElementById('predictionForm1').reset();
      document.getElementById('predictionForm2').reset();
    }

    function showHint() {
      if (!currentWardData) {
        alert('ë¨¼ì € ê²Œì„ì„ ì‹œì‘í•´ì£¼ì„¸ìš”.');
        return;
      }
      if (turnCount >= maxTurns) {
        alert('10ë²ˆì˜ íŒíŠ¸ë¥¼ ëª¨ë‘ ë°›ì•˜ìŠµë‹ˆë‹¤. ê²Œì„ì„ ë‹¤ì‹œ ì‹œì‘í•˜ì„¸ìš”.');
        return;
      }

      const wardName = document.getElementById('wardName').value.toUpperCase();
      if (!currentWardData.hasOwnProperty(wardName)) {
        alert('ì˜¬ë°”ë¥¸ ë³‘ë™ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (A, B, C, D, E ì¤‘ í•˜ë‚˜)');
        return;
      }

      const num = currentWardData[wardName];

      // ë‹¨ì¼ ìˆ«ìë§Œ ë°›ëŠ” íŒíŠ¸ í•¨ìˆ˜ ë°°ì—´ (hint.jsì—ì„œ ì •ì˜ë˜ì–´ ìˆì–´ì•¼ í•¨)
      const hintFunctions = [
        generateOddEvenClue,
        generateDigitCountClue,
        generateDivisorClue,
        generateDigitSumClue,
        generateGreaterThanClue,
        generateModClue,
        generateReverseCompareClue,
      ];

      // roomData í•„ìš” íŒíŠ¸ í•¨ìˆ˜ ë°°ì—´
      const roomHintFunctions = [
        generateEqualSumPairsClue,
        generateRankClue,
      ];

      function getRandomHint(num, roomData) {
        const allHints = [...hintFunctions, ...roomHintFunctions];
        let attempts = 0;
        while (attempts < 20) { // ìµœëŒ€ 20ë²ˆ ì‹œë„
          const idx = Math.floor(Math.random() * allHints.length);
          const selectedFn = allHints[idx];
          let hintResult;
          if (hintFunctions.includes(selectedFn)) {
            hintResult = selectedFn(num);
          } else {
            hintResult = selectedFn(roomData, wardName);
          }
          if (!usedHints.has(hintResult.clue)) {
            usedHints.add(hintResult.clue);
            return hintResult;
          }
          attempts++;
        }
        // ì¤‘ë³µ í”¼í•  ìˆ˜ ì—†ìœ¼ë©´ ê¸°ë³¸ íŒíŠ¸ ë°˜í™˜
        return { clue: "ë” ì´ìƒ ì¤‘ë³µë˜ì§€ ì•ŠëŠ” ìƒˆë¡œìš´ íŒíŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤." };
      }

      const result = getRandomHint(num, currentWardData);
      turnCount++;

      const output = document.getElementById('output');
      output.textContent += `\n[${turnCount}] ë³‘ë™ ${wardName} íŒíŠ¸: ${result.clue}`;

      if (turnCount === maxTurns) {
        output.textContent += `\n\nğŸ”” íŒíŠ¸ 12ë²ˆ ëª¨ë‘ ì‚¬ìš© ì™„ë£Œ! ì´ì œ ì˜ˆì¸¡ì„ ì œì¶œí•˜ì„¸ìš”.`;
      }
    }

    function submitPrediction(teamName) {
      if (!currentWardData) {
        alert('ë¨¼ì € ê²Œì„ì„ ì‹œì‘í•´ì£¼ì„¸ìš”.');
        return false;
      }

      // ê° ë³‘ë™ ì˜ˆì¸¡ê°’ ê°€ì ¸ì˜¤ê¸°
      const pred = {};
      for (const ward of ['A','B','C','D','E']) {
        const inputId = `pred${ward}${teamName === 'íŒ€ 1' ? '1' : '2'}`;
        const val = parseInt(document.getElementById(inputId).value);
        if (isNaN(val) || val < 0) {
          alert(`${teamName} - ë³‘ë™ ${ward}ì— ì˜¬ë°”ë¥¸ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.`);
          return false;
        }
        pred[ward] = val;
      }

      let totalScore = 0;
      let scoreDetails = `${teamName} ì ìˆ˜ ìƒì„¸:\n`;

      for (const ward of ['A','B','C','D','E']) {
        const actual = currentWardData[ward];
        const estimate = pred[ward];

        if (estimate === actual) {
          const score = actual + 10;
          totalScore += score;
          scoreDetails += `âœ… ë³‘ë™ ${ward}: ì •í™•! ì ìˆ˜ ${score}ì  (ì‹¤ì œê°’ ${actual} + ë³´ë„ˆìŠ¤ 10ì )\n`;
        } else if (estimate < actual) {
          totalScore += estimate;
          scoreDetails += `âš ï¸ ë³‘ë™ ${ward}: ê³¼ì†Œ ì¶”ì •, ì ìˆ˜ ${estimate}ì \n`;
        } else {
          scoreDetails += `âŒ ë³‘ë™ ${ward}: ê³¼ëŒ€ ì¶”ì •, ì ìˆ˜ 0ì  (ë³‘ë™ íì‡„)\n`;
        }
      }

      scoreDetails += `\nì´ ì ìˆ˜: ${totalScore}ì `;

      // ê²°ê³¼ ì¶œë ¥
      const scoreOutputId = teamName === 'íŒ€ 1' ? 'scoreOutput1' : 'scoreOutput2';
      document.getElementById(scoreOutputId).textContent = scoreDetails;

      scores[teamName] = totalScore;

      // ë‘ íŒ€ ì ìˆ˜ê°€ ë‹¤ ìˆìœ¼ë©´ ìµœì¢… ìŠ¹ì ì¶œë ¥
      if (scores['íŒ€ 1'] !== null && scores['íŒ€ 2'] !== null) {
        const finalResultEl = document.getElementById('finalResult');
        if (scores['íŒ€ 1'] > scores['íŒ€ 2']) {
          finalResultEl.textContent = `ğŸ† ìµœì¢… ìŠ¹ë¦¬: íŒ€ 1 (ì ìˆ˜ ${scores['íŒ€ 1']} vs ${scores['íŒ€ 2']})`;
        } else if (scores['íŒ€ 2'] > scores['íŒ€ 1']) {
          finalResultEl.textContent = `ğŸ† ìµœì¢… ìŠ¹ë¦¬: íŒ€ 2 (ì ìˆ˜ ${scores['íŒ€ 2']} vs ${scores['íŒ€ 1']})`;
        } else {
          finalResultEl.textContent = `ğŸ¤ ë¬´ìŠ¹ë¶€ (ì ìˆ˜ ${scores['íŒ€ 1']} vs ${scores['íŒ€ 2']})`;
        }
      }

      return false; // form ì œì¶œ ë§‰ê¸°
    }
  </script>
</body>
</html>
